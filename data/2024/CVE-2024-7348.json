{
  "_annotation": {
    "cna": "postgresql",
    "cve_id": "CVE-2024-7348",
    "description": "Time-of-check Time-of-use (TOCTOU) race condition in pg_dump in PostgreSQL allows an object creator to execute arbitrary SQL functions as the user running pg_dump, which is often a superuser. The attack involves replacing another relation type with a view or foreign table. The attack requires waiting for pg_dump to start, but winning the race condition is trivial if the attacker retains an open transaction. Versions before PostgreSQL 16.4, 15.8, 14.13, 13.16, and 12.20 are affected.",
    "generated_from": "https://raw.githubusercontent.com/anchore/cve-data-enrichment/main/data/anchore/2024/CVE-2024-7348.json",
    "reason": "Added CPE configurations because not yet analyzed by NVD.",
    "references": [
      "https://www.postgresql.org/support/security/CVE-2024-7348/"
    ]
  },
  "cve": {
    "configurations": [
      {
        "nodes": [
          {
            "cpeMatch": [
              {
                "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "BEA3E8D4-F5FD-57A2-BE4F-1A67693C9B20",
                "versionEndExcluding": "16.4",
                "versionStartIncluding": "16",
                "vulnerable": true
              },
              {
                "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "32EA75EA-1A2D-53EE-9700-C5E603286C40",
                "versionEndExcluding": "15.8",
                "versionStartIncluding": "15",
                "vulnerable": true
              },
              {
                "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "2B518EE1-7863-59B3-9DB2-C70BC10F44A7",
                "versionEndExcluding": "14.13",
                "versionStartIncluding": "14",
                "vulnerable": true
              },
              {
                "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "B446D9AA-C182-592F-9774-FF8D7DE5AD68",
                "versionEndExcluding": "13.16",
                "versionStartIncluding": "13",
                "vulnerable": true
              },
              {
                "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "D08321C4-5081-5BA8-8F35-737EC879CCA1",
                "versionEndExcluding": "12.20",
                "vulnerable": true
              }
            ],
            "negate": false,
            "operator": "OR"
          }
        ]
      }
    ]
  }
}