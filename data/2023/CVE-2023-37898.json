{
  "_annotation": {
    "cna": "github_m",
    "cve_id": "CVE-2023-37898",
    "description": "Joplin is a free, open source note taking and to-do application. A Cross-site Scripting (XSS) vulnerability allows an untrusted note opened in safe mode to execute arbitrary code. `packages/renderer/MarkupToHtml.ts` renders note content in safe mode by surrounding it with <pre> and </pre>, without escaping any interior HTML tags. Thus, an attacker can create a note that closes the opening <pre> tag, then includes HTML that runs JavaScript. Because the rendered markdown iframe has the same origin as the toplevel document and is not sandboxed, any scripts running in the preview iframe can access the top variable and, thus, access the toplevel NodeJS `require` function. `require` can then be used to import modules like fs or child_process and run arbitrary commands. This issue has been addressed in version 2.12.9 and all users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "generated_from": "https://raw.githubusercontent.com/anchore/cve-data-enrichment/main/data/anchore/2023/CVE-2023-37898.json",
    "reason": "Added CPE configurations because not yet analyzed by NVD.",
    "references": [
      "https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#sandbox",
      "https://github.com/laurent22/joplin/security/advisories/GHSA-hjmq-3qh4-g2r8"
    ]
  },
  "cve": {
    "configurations": [
      {
        "nodes": [
          {
            "cpeMatch": [
              {
                "criteria": "cpe:2.3:a:joplin_project:joplin-renderer:*:*:*:*:*:node.js:*:*",
                "matchCriteriaId": "100999CA-E0ED-598C-A190-565CB1549D30",
                "versionEndExcluding": "2.12.9",
                "vulnerable": true
              }
            ],
            "negate": false,
            "operator": "OR"
          }
        ]
      },
      {
        "nodes": [
          {
            "cpeMatch": [
              {
                "criteria": "cpe:2.3:a:joplin_project:\\@joplinapp\\/renderer:*:*:*:*:*:node.js:*:*",
                "matchCriteriaId": "E18DEA14-1993-55EA-B372-EED416D05284",
                "versionEndExcluding": "2.12.9",
                "vulnerable": true
              }
            ],
            "negate": false,
            "operator": "OR"
          }
        ]
      },
      {
        "nodes": [
          {
            "cpeMatch": [
              {
                "criteria": "cpe:2.3:a:joplin_project:\\@joplin\\/renderer:*:*:*:*:*:node.js:*:*",
                "matchCriteriaId": "3F2A5017-C57A-537C-8F61-2D66F24E4B48",
                "versionEndExcluding": "2.12.9",
                "vulnerable": true
              }
            ],
            "negate": false,
            "operator": "OR"
          }
        ]
      }
    ],
    "references": [
      {
        "source": "anchoreadp",
        "url": "https://github.com/laurent22/joplin/pull/8507"
      },
      {
        "source": "anchoreadp",
        "url": "https://github.com/laurent22/joplin/commit/955f724d364b795032eb9539f0bfc86e1390ec7e"
      }
    ]
  }
}