{
  "_annotation": {
    "cna": "gitlab",
    "cve_id": "CVE-2023-5332",
    "description": "Patch in third party library Consul requires 'enable-script-checks' to be set to False. This was required to enable a patch by the vendor. Without this setting the patch could be bypassed. This only affects GitLab-EE.",
    "generated_from": "https://raw.githubusercontent.com/anchore/cve-data-enrichment/main/data/anchore/2023/CVE-2023-5332.json",
    "reason": "Enhance with deb and rpm package type records",
    "references": [
      "https://gitlab.com/gitlab-org/omnibus-gitlab/-/issues/8171",
      "https://www.hashicorp.com/blog/protecting-consul-from-rce-risk-in-specific-configurations"
    ]
  },
  "cve": {
    "configurations": [
      {
        "nodes": [
          {
            "cpeMatch": [
              {
                "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*",
                "matchCriteriaId": "D2A9F08F-3E67-4BAF-98E5-C211E320BD55",
                "versionEndExcluding": "16.2.8",
                "versionStartIncluding": "9.5.0",
                "vulnerable": true
              },
              {
                "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*",
                "matchCriteriaId": "CC5696C9-592A-4D50-B5BB-9A250DAB6589",
                "versionEndExcluding": "16.3.5",
                "versionStartIncluding": "16.3.0",
                "vulnerable": true
              },
              {
                "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*",
                "matchCriteriaId": "05DB2898-766D-5065-818D-48C71346848C",
                "versionEndExcluding": "16.4.1",
                "versionStartIncluding": "16.4",
                "vulnerable": true
              }
            ],
            "negate": false,
            "operator": "OR"
          },
          {
            "cpeMatch": [
              {
                "criteria": "cpe:2.3:a:gitlab:gitlab_enterprise:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "A0DBEDF6-FD5F-5BE0-86A7-5B564FE132BA",
                "versionEndExcluding": "16.2.8",
                "versionStartIncluding": "9.5.0",
                "vulnerable": true
              },
              {
                "criteria": "cpe:2.3:a:gitlab:gitlab_enterprise:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "231FAA1E-574E-55C5-96F1-D3BA95434A6B",
                "versionEndExcluding": "16.3.5",
                "versionStartIncluding": "16.3.0",
                "vulnerable": true
              },
              {
                "criteria": "cpe:2.3:a:gitlab:gitlab_enterprise:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "E6273DD6-5BB1-5B8B-949D-52C1E1714C47",
                "versionEndExcluding": "16.4.1",
                "versionStartIncluding": "16.4",
                "vulnerable": true
              }
            ],
            "negate": false,
            "operator": "OR"
          }
        ]
      },
      {
        "nodes": [
          {
            "cpeMatch": [
              {
                "criteria": "cpe:2.3:a:hashicorp:consul:*:*:*:*:*:go:*:*",
                "matchCriteriaId": "59D71AA8-3F21-5AE7-A481-51385BDF576B",
                "versionEndExcluding": "1.2.4",
                "versionStartIncluding": "1.2.0",
                "vulnerable": true
              },
              {
                "criteria": "cpe:2.3:a:hashicorp:consul:*:*:*:*:*:go:*:*",
                "matchCriteriaId": "16EE46B6-8409-55C2-A377-0F9F0658F918",
                "versionEndExcluding": "1.1.1",
                "versionStartIncluding": "1.1",
                "vulnerable": true
              },
              {
                "criteria": "cpe:2.3:a:hashicorp:consul:*:*:*:*:*:go:*:*",
                "matchCriteriaId": "E96CD0F5-240F-5207-8ED4-97AF888069FE",
                "versionEndExcluding": "1.0.8",
                "versionStartIncluding": "1.0",
                "vulnerable": true
              },
              {
                "criteria": "cpe:2.3:a:hashicorp:consul:*:*:*:*:*:go:*:*",
                "matchCriteriaId": "4FDF3617-E4FD-5407-9430-2BAA53374087",
                "versionEndExcluding": "0.9.4",
                "vulnerable": true
              }
            ],
            "negate": false,
            "operator": "OR"
          }
        ]
      }
    ]
  }
}