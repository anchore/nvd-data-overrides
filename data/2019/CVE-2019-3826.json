{
  "_annotation": {
    "cna": "redhat",
    "cve_id": "CVE-2019-3826",
    "description": "A stored, DOM based, cross-site scripting (XSS) flaw was found in Prometheus before version 2.7.1. An attacker could exploit this by convincing an authenticated user to visit a crafted URL on a Prometheus server, allowing for the execution and persistent storage of arbitrary scripts.",
    "generated_from": "https://raw.githubusercontent.com/anchore/cve-data-enrichment/main/data/anchore/2019/CVE-2019-3826.json",
    "modified": "2024-08-04T19:19:18.663Z",
    "published": "2019-03-26T17:48:31",
    "reason": "Prometheus is a go application and the web ui component is vulnerable; however, most applications using the prometheus go library as a go dependency will not be using the UI components and therefore would not be vulnerable, hence why GitHub withdrew the GHSA on this.  The issue is that the go module name is the same for prometheus the binary and prometheus the client lib.  To further complicate matters, the go module has weird versioning compared to the application as explained in https://github.com/kubernetes-sigs/metrics-server/issues/1691#issuecomment-3114285641.  For this reason, for now the lower bounds on the affected range is set to 1.0.0, since all of the recent and unaffected versions should be using the new weird versining scheme that will appear as <1.0.0 and therefore be excluded from the affected range.  This probably won't be perfect, but will have to suffice for now",
    "references": [
      "https://access.redhat.com/errata/RHBA-2019:0327",
      "https://advisory.checkmarx.net/advisory/CX-2019-4297",
      "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3826",
      "https://github.com/prometheus/prometheus/commit/62e591f9",
      "https://github.com/prometheus/prometheus/pull/5163",
      "https://lists.apache.org/thread.html/r48d5019bd42e0770f7e5351e420a63a41ff1f16924942442c6aff6a8%40%3Ccommits.zookeeper.apache.org%3E",
      "https://lists.apache.org/thread.html/r8e3f7da12bf5750b0a02e69a78a61073a2ac950eed7451ce70a65177%40%3Ccommits.zookeeper.apache.org%3E",
      "https://lists.apache.org/thread.html/rdf2a0d94c3b5b523aeff7741ae71347415276062811b687f30ea6573%40%3Ccommits.zookeeper.apache.org%3E"
    ]
  },
  "cve": {
    "configurations": [
      {
        "nodes": [
          {
            "cpeMatch": [
              {
                "criteria": "cpe:2.3:a:prometheus:prometheus:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "6C767523-F24D-5B24-B274-9D57EDD1D1D1",
                "versionEndExcluding": "2.7.1",
                "versionStartIncluding": "1.0.0",
                "vulnerable": true
              }
            ],
            "negate": false,
            "operator": "OR"
          }
        ]
      }
    ]
  }
}