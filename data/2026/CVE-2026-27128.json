{
  "_annotation": {
    "cna": "github_m",
    "cve_id": "CVE-2026-27128",
    "description": "Craft is a content management system (CMS). In versions 4.5.0-RC1 through 4.16.18 and 5.0.0-RC1 through 5.8.22, a Time-of-Check-Time-of-Use (TOCTOU) race condition exists in Craft CMS’s token validation service for tokens that explicitly set a limited usage. The `getTokenRoute()` method reads a token’s usage count, checks if it’s within limits, then updates the database in separate non-atomic operations. By sending concurrent requests, an attacker can use a single-use impersonation token multiple times before the database update completes. To make this work, an attacker needs to obtain a valid user account impersonation URL with a non-expired token via some other means and exploit a race condition while bypassing any rate-limiting rules in place. For this to be a privilege escalation, the impersonation URL must include a token for a user account with more permissions than the current user. Versions 4.16.19 and 5.8.23 patch the issue.",
    "generated_from": "https://raw.githubusercontent.com/anchore/cve-data-enrichment/main/data/anchore/2026/CVE-2026-27128.json",
    "modified": "2026-02-24T02:42:53.706000+00:00",
    "published": "2026-02-24T02:42:53.706000+00:00",
    "reason": "Added CPE configurations because not yet analyzed by NVD.",
    "references": [
      "https://github.com/craftcms/cms/commit/3e4afe18279951c024c64896aa2b93cda6d95fdf",
      "https://github.com/craftcms/cms/security/advisories/GHSA-6fx5-5cw5-4897"
    ]
  },
  "cve": {
    "configurations": [
      {
        "nodes": [
          {
            "cpeMatch": [
              {
                "criteria": "cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:php:*:*",
                "matchCriteriaId": "309EDAC3-9F71-57EB-B1F2-CE111692257C",
                "versionEndExcluding": "4.16.19",
                "versionStartIncluding": "4.5.0-rc1",
                "vulnerable": true
              },
              {
                "criteria": "cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:php:*:*",
                "matchCriteriaId": "581E8FB3-678A-5A84-8E56-4CF850F57120",
                "versionEndExcluding": "5.8.23",
                "versionStartIncluding": "5.0.0-rc1",
                "vulnerable": true
              }
            ],
            "negate": false,
            "operator": "OR"
          }
        ]
      }
    ]
  }
}